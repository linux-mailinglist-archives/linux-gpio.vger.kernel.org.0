Return-Path: <linux-gpio-owner@vger.kernel.org>
X-Original-To: lists+linux-gpio@lfdr.de
Delivered-To: lists+linux-gpio@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 8DE4A144C0B
	for <lists+linux-gpio@lfdr.de>; Wed, 22 Jan 2020 07:54:01 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726005AbgAVGxa (ORCPT <rfc822;lists+linux-gpio@lfdr.de>);
        Wed, 22 Jan 2020 01:53:30 -0500
Received: from mailgw02.mediatek.com ([210.61.82.184]:7754 "EHLO
        mailgw02.mediatek.com" rhost-flags-OK-FAIL-OK-FAIL) by vger.kernel.org
        with ESMTP id S1725883AbgAVGxa (ORCPT
        <rfc822;linux-gpio@vger.kernel.org>); Wed, 22 Jan 2020 01:53:30 -0500
X-UUID: 075dc211d6584a7ab46d399130398334-20200122
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=mediatek.com; s=dk;
        h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:In-Reply-To:Message-ID:Date:Subject:CC:To:From; bh=7OjjstGC5xIIjdBfkyYXXt4Wjc81fNGRpa4Ftl+Dwdw=;
        b=axBQbYyHdyALkoD0HFP/PHTCuEETLM+BlAYen1UK55C85JFIy9iIE33qY8Mq2R8hNQEXBSv5x+5ZGeaP3eJYVzvP1Vii8cN3Eyq4DzSpWzJrV8GlJh8wXw6aFY0ixpz5zYiMMBktxjYNE7U8/sMjsmQgaZycPA9k9IvDGyl51XU=;
X-UUID: 075dc211d6584a7ab46d399130398334-20200122
Received: from mtkcas07.mediatek.inc [(172.21.101.84)] by mailgw02.mediatek.com
        (envelope-from <light.hsieh@mediatek.com>)
        (Cellopoint E-mail Firewall v4.1.10 Build 0809 with TLS)
        with ESMTP id 1812003967; Wed, 22 Jan 2020 14:53:18 +0800
Received: from mtkcas07.mediatek.inc (172.21.101.84) by
 mtkmbs08n2.mediatek.inc (172.21.101.56) with Microsoft SMTP Server (TLS) id
 15.0.1395.4; Wed, 22 Jan 2020 14:51:43 +0800
Received: from mtkswgap22.mediatek.inc (172.21.77.33) by mtkcas07.mediatek.inc
 (172.21.101.73) with Microsoft SMTP Server id 15.0.1395.4 via Frontend
 Transport; Wed, 22 Jan 2020 14:51:58 +0800
From:   <light.hsieh@mediatek.com>
To:     <linus.walleij@linaro.org>
CC:     <linux-mediatek@lists.infradead.org>, <linux-gpio@vger.kernel.org>,
        <linux-kernel@vger.kernel.org>, <sean.wang@kernel.org>,
        <kuohong.wang@mediatek.com>, Light Hsieh <light.hsieh@mediatek.com>
Subject: [PATCH v8 5/6] pinctrl: mediatek: Backward compatible to previous Mediatek's bias-pull usage
Date:   Wed, 22 Jan 2020 14:53:13 +0800
Message-ID: <1579675994-7001-5-git-send-email-light.hsieh@mediatek.com>
X-Mailer: git-send-email 1.8.1.1.dirty
In-Reply-To: <1579675994-7001-1-git-send-email-light.hsieh@mediatek.com>
References: <1579675994-7001-1-git-send-email-light.hsieh@mediatek.com>
MIME-Version: 1.0
Content-Type: text/plain
X-TM-SNTS-SMTP: 251766DBEF914E5B8469C5B2B635538D4A613EB88F702CEC8F17E9D8F3BFD35E2000:8
X-MTK:  N
Content-Transfer-Encoding: base64
Sender: linux-gpio-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-gpio.vger.kernel.org>
X-Mailing-List: linux-gpio@vger.kernel.org

RnJvbTogTGlnaHQgSHNpZWggPGxpZ2h0LmhzaWVoQG1lZGlhdGVrLmNvbT4NCg0KUmVmaW5lIG10
a19waW5jb25mX3NldCgpL210a19waW5jb25mX2dldCgpIGZvciBiYWNrd2FyZCBjb21wYXRpYmls
aXR5IHRvDQpwcmV2aW91cyBNZWRpYVRlaydzIGJpYXMtcHVsbCB1c2FnZS4NCkluIFBJTkNUUkxf
TVRLIHRoYXQgdXNlIHBpbmN0cmwtbXRrLWNvbW1vbi5jLCBiaWFzLXB1bGwgc2V0dGluZyBmb3Ig
cGlucw0Kd2l0aCAyIHB1bGwgcmVzaXN0b3JzIGNhbiBiZSBzcGVjaWZpZWQgYXMgdmFsdWUgZm9y
IGJpYXMtcHVsbC11cCBhbmQNCmJpYXMtcHVsbC1kb3duLiBGb3IgZXhhbXBsZToNCiAgICBiaWFz
LXB1bGwtdXAgPSA8TVRLX1BVUERfU0VUX1IxUjBfMDA+Ow0KICAgIGJpYXMtcHVsbC11cCA9IDxN
VEtfUFVQRF9TRVRfUjFSMF8wMT47DQogICAgYmlhcy1wdWxsLXVwID0gPE1US19QVVBEX1NFVF9S
MVIwXzEwPjsNCiAgICBiaWFzLXB1bGwtdXAgPSA8TVRLX1BVUERfU0VUX1IxUjBfMTE+Ow0KICAg
IGJpYXMtcHVsbC1kb3duID0gPE1US19QVVBEX1NFVF9SMVIwXzAwPjsNCiAgICBiaWFzLXB1bGwt
ZG93biA9IDxNVEtfUFVQRF9TRVRfUjFSMF8wMT47DQogICAgYmlhcy1wdWxsLWRvd24gPSA8TVRL
X1BVUERfU0VUX1IxUjBfMTA+Ow0KICAgIGJpYXMtcHVsbC1kb3duID0gPE1US19QVVBEX1NFVF9S
MVIwXzExPjsNCg0KT24gdGhlIG90aGVyIGhhbmQsIFBJTkNUUkxfTVRLX1BBUklTIHVzZSBjdXN0
b21pemVkIHByb3BlcnRpZXMNCiJtZWRpYXRlayxwdWxsLXVwLWFkdiIgYW5kICJtZWRpYXRlayxw
dWxsLWRvd24tYWR2IiB0byBzcGVjaWZ5IGJpYXMtcHVsbA0Kc2V0dGluZyBmb3IgcGlucyB3aXRo
IDIgcHVsbCByZXNpc3RvcnMuDQpUaGlzIGludHJvZHVjZSBpbi1jb21wYXRpYmlsaXR5IGluIGRl
dmljZSB0cmVlIGFuZCBpbmNyZWFzZSBwb3J0aW5nDQplZmZvcnQgdG8gTWVkaWFUZWsncyBjdXN0
b21lciB0aGF0IGhhZCBhbHJlYWR5IHVzZWQgUElOQ1RSTF9NVEsgdmVyc2lvbi4NCkJlc2lkZXMs
IGlmIGN1c3RvbWVycyBhcmUgbm90IGF3YXJlIG9mIHRoaXMgY2hhbmdlIGFuZCBzdGlsbCB3cml0
ZSBkZXZpY2V0cmVlDQpmb3IgUElOQ1RSTF9NVEsgdmVyc2lvbiwgdGhleSBtYXkgZW5jb3VudGVy
IHJ1bnRpbWUgZmFpbHVyZSB3aXRoIHBpbmN0cmwgYW5kDQpzcGVudCB0aW1lIHRvIGRlYnVnLg0K
DQpUaGlzIHBhdGNoIGFkZHMgYmFja3dhcmQgY29tcGF0aWJsZSB0byBwcmV2aW91cyBNZWRpYVRl
aydzIGJpYXMtcHVsbCB1c2FnZQ0Kc28gdGhhdCBNZWRpYXRlaydzIGN1c3RvbWVyIG5lZWQgbm90
IHVzZSBhIG5ldyBkZXZpY2V0cmVlIHByb3BlcnR5IG5hbWUuDQpUaGUgcmF0aW9uYWxlIGlzIHRo
YXQ6IGNoYW5naW5nIGRyaXZlciBpbXBsZW1lbnRhdGlvbiBoYWQgYmV0dGVyIGxlYXZlDQppbnRl
cmZhY2UgdW5jaGFuZ2VkLg0KDQpTaWduZWQtb2ZmLWJ5OiBMaWdodCBIc2llaCA8bGlnaHQuaHNp
ZWhAbWVkaWF0ZWsuY29tPg0KLS0tDQogZHJpdmVycy9waW5jdHJsL21lZGlhdGVrL3BpbmN0cmwt
bXQ2NzY1LmMgICAgICAgIHwgICA2ICstDQogZHJpdmVycy9waW5jdHJsL21lZGlhdGVrL3BpbmN0
cmwtbXQ4MTgzLmMgICAgICAgIHwgICA2ICstDQogZHJpdmVycy9waW5jdHJsL21lZGlhdGVrL3Bp
bmN0cmwtbXRrLWNvbW1vbi12Mi5jIHwgMjIxICsrKysrKysrKysrKysrKysrKysrKysrDQogZHJp
dmVycy9waW5jdHJsL21lZGlhdGVrL3BpbmN0cmwtbXRrLWNvbW1vbi12Mi5oIHwgIDExICsrDQog
ZHJpdmVycy9waW5jdHJsL21lZGlhdGVrL3BpbmN0cmwtcGFyaXMuYyAgICAgICAgIHwgIDQ5ICsr
Ky0tDQogNSBmaWxlcyBjaGFuZ2VkLCAyNjUgaW5zZXJ0aW9ucygrKSwgMjggZGVsZXRpb25zKC0p
DQoNCmRpZmYgLS1naXQgYS9kcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1tdDY3NjUu
YyBiL2RyaXZlcnMvcGluY3RybC9tZWRpYXRlay9waW5jdHJsLW10Njc2NS5jDQppbmRleCA3ZmFl
Mzk3Li45MDVkYWU4YyAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvcGluY3RybC9tZWRpYXRlay9waW5j
dHJsLW10Njc2NS5jDQorKysgYi9kcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1tdDY3
NjUuYw0KQEAgLTEwNzIsMTAgKzEwNzIsOCBAQA0KIAkuZ3Bpb19tID0gMCwNCiAJLmJhc2VfbmFt
ZXMgPSBtdDY3NjVfcGluY3RybF9yZWdpc3Rlcl9iYXNlX25hbWVzLA0KIAkubmJhc2VfbmFtZXMg
PSBBUlJBWV9TSVpFKG10Njc2NV9waW5jdHJsX3JlZ2lzdGVyX2Jhc2VfbmFtZXMpLA0KLQkuYmlh
c19kaXNhYmxlX3NldCA9IG10a19waW5jb25mX2JpYXNfZGlzYWJsZV9zZXQsDQotCS5iaWFzX2Rp
c2FibGVfZ2V0ID0gbXRrX3BpbmNvbmZfYmlhc19kaXNhYmxlX2dldCwNCi0JLmJpYXNfc2V0ID0g
bXRrX3BpbmNvbmZfYmlhc19zZXQsDQotCS5iaWFzX2dldCA9IG10a19waW5jb25mX2JpYXNfZ2V0
LA0KKwkuYmlhc19zZXRfY29tYm8gPSBtdGtfcGluY29uZl9iaWFzX3NldF9jb21ibywNCisJLmJp
YXNfZ2V0X2NvbWJvID0gbXRrX3BpbmNvbmZfYmlhc19nZXRfY29tYm8sDQogCS5kcml2ZV9zZXQg
PSBtdGtfcGluY29uZl9kcml2ZV9zZXRfcmF3LA0KIAkuZHJpdmVfZ2V0ID0gbXRrX3BpbmNvbmZf
ZHJpdmVfZ2V0X3JhdywNCiAJLmFkdl9wdWxsX2dldCA9IG10a19waW5jb25mX2Fkdl9wdWxsX2dl
dCwNCmRpZmYgLS1naXQgYS9kcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1tdDgxODMu
YyBiL2RyaXZlcnMvcGluY3RybC9tZWRpYXRlay9waW5jdHJsLW10ODE4My5jDQppbmRleCA0ZWNh
ODE4Li42MDMxODMzIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9waW5jdHJsL21lZGlhdGVrL3BpbmN0
cmwtbXQ4MTgzLmMNCisrKyBiL2RyaXZlcnMvcGluY3RybC9tZWRpYXRlay9waW5jdHJsLW10ODE4
My5jDQpAQCAtNTU2LDEwICs1NTYsOCBAQA0KIAkuZ3Bpb19tID0gMCwNCiAJLmJhc2VfbmFtZXMg
PSBtdDgxODNfcGluY3RybF9yZWdpc3Rlcl9iYXNlX25hbWVzLA0KIAkubmJhc2VfbmFtZXMgPSBB
UlJBWV9TSVpFKG10ODE4M19waW5jdHJsX3JlZ2lzdGVyX2Jhc2VfbmFtZXMpLA0KLQkuYmlhc19k
aXNhYmxlX3NldCA9IG10a19waW5jb25mX2JpYXNfZGlzYWJsZV9zZXRfcmV2MSwNCi0JLmJpYXNf
ZGlzYWJsZV9nZXQgPSBtdGtfcGluY29uZl9iaWFzX2Rpc2FibGVfZ2V0X3JldjEsDQotCS5iaWFz
X3NldCA9IG10a19waW5jb25mX2JpYXNfc2V0X3JldjEsDQotCS5iaWFzX2dldCA9IG10a19waW5j
b25mX2JpYXNfZ2V0X3JldjEsDQorCS5iaWFzX3NldF9jb21ibyA9IG10a19waW5jb25mX2JpYXNf
c2V0X2NvbWJvLA0KKwkuYmlhc19nZXRfY29tYm8gPSBtdGtfcGluY29uZl9iaWFzX2dldF9jb21i
bywNCiAJLmRyaXZlX3NldCA9IG10a19waW5jb25mX2RyaXZlX3NldF9yZXYxLA0KIAkuZHJpdmVf
Z2V0ID0gbXRrX3BpbmNvbmZfZHJpdmVfZ2V0X3JldjEsDQogCS5hZHZfcHVsbF9nZXQgPSBtdGtf
cGluY29uZl9hZHZfcHVsbF9nZXQsDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9waW5jdHJsL21lZGlh
dGVrL3BpbmN0cmwtbXRrLWNvbW1vbi12Mi5jIGIvZHJpdmVycy9waW5jdHJsL21lZGlhdGVrL3Bp
bmN0cmwtbXRrLWNvbW1vbi12Mi5jDQppbmRleCAyMjQ3ZWFlLi4xZGE5NDI1IDEwMDY0NA0KLS0t
IGEvZHJpdmVycy9waW5jdHJsL21lZGlhdGVrL3BpbmN0cmwtbXRrLWNvbW1vbi12Mi5jDQorKysg
Yi9kcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1tdGstY29tbW9uLXYyLmMNCkBAIC02
LDYgKzYsNyBAQA0KICAqDQogICovDQogDQorI2luY2x1ZGUgPGR0LWJpbmRpbmdzL3BpbmN0cmwv
bXQ2NXh4Lmg+DQogI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPg0KICNpbmNsdWRlIDxsaW51eC9l
cnIuaD4NCiAjaW5jbHVkZSA8bGludXgvZ3Bpby9kcml2ZXIuaD4NCkBAIC01MTcsNiArNTE4LDIy
NiBAQCBpbnQgbXRrX3BpbmNvbmZfYmlhc19nZXRfcmV2MShzdHJ1Y3QgbXRrX3BpbmN0cmwgKmh3
LA0KIAlyZXR1cm4gMDsNCiB9DQogDQorLyogQ29tYm8gZm9yIHRoZSBmb2xsb3dpbmcgcHVsbCBy
ZWdpc3RlciB0eXBlOg0KKyAqIDEuIFBVICsgUEQNCisgKiAyLiBQVUxMU0VMICsgUFVMTEVODQor
ICogMy4gUFVQRCArIFIwICsgUjENCisgKi8NCitzdGF0aWMgaW50IG10a19waW5jb25mX2JpYXNf
c2V0X3B1X3BkKHN0cnVjdCBtdGtfcGluY3RybCAqaHcsDQorCQkJCWNvbnN0IHN0cnVjdCBtdGtf
cGluX2Rlc2MgKmRlc2MsDQorCQkJCXUzMiBwdWxsdXAsIHUzMiBhcmcpDQorew0KKwlpbnQgZXJy
LCBwdSwgcGQ7DQorDQorCWlmIChhcmcgPT0gTVRLX0RJU0FCTEUpIHsNCisJCXB1ID0gMDsNCisJ
CXBkID0gMDsNCisJfSBlbHNlIGlmICgoYXJnID09IE1US19FTkFCTEUpICYmIHB1bGx1cCkgew0K
KwkJcHUgPSAxOw0KKwkJcGQgPSAwOw0KKwl9IGVsc2UgaWYgKChhcmcgPT0gTVRLX0VOQUJMRSkg
JiYgIXB1bGx1cCkgew0KKwkJcHUgPSAwOw0KKwkJcGQgPSAxOw0KKwl9IGVsc2Ugew0KKwkJZXJy
ID0gLUVJTlZBTDsNCisJCWdvdG8gb3V0Ow0KKwl9DQorDQorCWVyciA9IG10a19od19zZXRfdmFs
dWUoaHcsIGRlc2MsIFBJTkNUUkxfUElOX1JFR19QVSwgcHUpOw0KKwlpZiAoZXJyKQ0KKwkJZ290
byBvdXQ7DQorDQorCWVyciA9IG10a19od19zZXRfdmFsdWUoaHcsIGRlc2MsIFBJTkNUUkxfUElO
X1JFR19QRCwgcGQpOw0KKw0KK291dDoNCisJcmV0dXJuIGVycjsNCit9DQorDQorc3RhdGljIGlu
dCBtdGtfcGluY29uZl9iaWFzX3NldF9wdWxsc2VsX3B1bGxlbihzdHJ1Y3QgbXRrX3BpbmN0cmwg
Kmh3LA0KKwkJCQljb25zdCBzdHJ1Y3QgbXRrX3Bpbl9kZXNjICpkZXNjLA0KKwkJCQl1MzIgcHVs
bHVwLCB1MzIgYXJnKQ0KK3sNCisJaW50IGVyciwgZW5hYmxlOw0KKw0KKwlpZiAoYXJnID09IE1U
S19ESVNBQkxFKQ0KKwkJZW5hYmxlID0gMDsNCisJZWxzZSBpZiAoYXJnID09IE1US19FTkFCTEUp
DQorCQllbmFibGUgPSAxOw0KKwllbHNlIHsNCisJCWVyciA9IC1FSU5WQUw7DQorCQlnb3RvIG91
dDsNCisJfQ0KKw0KKwllcnIgPSBtdGtfaHdfc2V0X3ZhbHVlKGh3LCBkZXNjLCBQSU5DVFJMX1BJ
Tl9SRUdfUFVMTEVOLCBlbmFibGUpOw0KKwlpZiAoZXJyKQ0KKwkJZ290byBvdXQ7DQorDQorCWVy
ciA9IG10a19od19zZXRfdmFsdWUoaHcsIGRlc2MsIFBJTkNUUkxfUElOX1JFR19QVUxMU0VMLCBw
dWxsdXApOw0KKw0KK291dDoNCisJcmV0dXJuIGVycjsNCit9DQorDQorc3RhdGljIGludCBtdGtf
cGluY29uZl9iaWFzX3NldF9wdXBkX3IxX3IwKHN0cnVjdCBtdGtfcGluY3RybCAqaHcsDQorCQkJ
CWNvbnN0IHN0cnVjdCBtdGtfcGluX2Rlc2MgKmRlc2MsDQorCQkJCXUzMiBwdWxsdXAsIHUzMiBh
cmcpDQorew0KKwlpbnQgZXJyLCByMCwgcjE7DQorDQorCWlmICgoYXJnID09IE1US19ESVNBQkxF
KSB8fCAoYXJnID09IE1US19QVVBEX1NFVF9SMVIwXzAwKSkgew0KKwkJcHVsbHVwID0gMDsNCisJ
CXIwID0gMDsNCisJCXIxID0gMDsNCisJfSBlbHNlIGlmIChhcmcgPT0gTVRLX1BVUERfU0VUX1Ix
UjBfMDEpIHsNCisJCXIwID0gMTsNCisJCXIxID0gMDsNCisJfSBlbHNlIGlmIChhcmcgPT0gTVRL
X1BVUERfU0VUX1IxUjBfMTApIHsNCisJCXIwID0gMDsNCisJCXIxID0gMTsNCisJfSBlbHNlIGlm
IChhcmcgPT0gTVRLX1BVUERfU0VUX1IxUjBfMTEpIHsNCisJCXIwID0gMTsNCisJCXIxID0gMTsN
CisJfSBlbHNlIHsNCisJCWVyciA9IC1FSU5WQUw7DQorCQlnb3RvIG91dDsNCisJfQ0KKw0KKwkv
KiBNVEsgSFcgUFVQRCBiaXQ6IDEgZm9yIHB1bGwtZG93biwgMCBmb3IgcHVsbC11cCAqLw0KKwll
cnIgPSBtdGtfaHdfc2V0X3ZhbHVlKGh3LCBkZXNjLCBQSU5DVFJMX1BJTl9SRUdfUFVQRCwgIXB1
bGx1cCk7DQorCWlmIChlcnIpDQorCQlnb3RvIG91dDsNCisNCisJZXJyID0gbXRrX2h3X3NldF92
YWx1ZShodywgZGVzYywgUElOQ1RSTF9QSU5fUkVHX1IwLCByMCk7DQorCWlmIChlcnIpDQorCQln
b3RvIG91dDsNCisNCisJZXJyID0gbXRrX2h3X3NldF92YWx1ZShodywgZGVzYywgUElOQ1RSTF9Q
SU5fUkVHX1IxLCByMSk7DQorDQorb3V0Og0KKwlyZXR1cm4gZXJyOw0KK30NCisNCitzdGF0aWMg
aW50IG10a19waW5jb25mX2JpYXNfZ2V0X3B1X3BkKHN0cnVjdCBtdGtfcGluY3RybCAqaHcsDQor
CQkJCWNvbnN0IHN0cnVjdCBtdGtfcGluX2Rlc2MgKmRlc2MsDQorCQkJCXUzMiAqcHVsbHVwLCB1
MzIgKmVuYWJsZSkNCit7DQorCWludCBlcnIsIHB1LCBwZDsNCisNCisJZXJyID0gbXRrX2h3X2dl
dF92YWx1ZShodywgZGVzYywgUElOQ1RSTF9QSU5fUkVHX1BVLCAmcHUpOw0KKwlpZiAoZXJyKQ0K
KwkJZ290byBvdXQ7DQorDQorCWVyciA9IG10a19od19nZXRfdmFsdWUoaHcsIGRlc2MsIFBJTkNU
UkxfUElOX1JFR19QRCwgJnBkKTsNCisJaWYgKGVycikNCisJCWdvdG8gb3V0Ow0KKw0KKwlpZiAo
cHUgPT0gMCAmJiBwZCA9PSAwKSB7DQorCQkqcHVsbHVwID0gMDsNCisJCSplbmFibGUgPSBNVEtf
RElTQUJMRTsNCisJfSBlbHNlIGlmIChwdSA9PSAxICYmIHBkID09IDApIHsNCisJCSpwdWxsdXAg
PSAxOw0KKwkJKmVuYWJsZSA9IE1US19FTkFCTEU7DQorCX0gZWxzZSBpZiAocHUgPT0gMCAmJiBw
ZCA9PSAxKSB7DQorCQkqcHVsbHVwID0gMDsNCisJCSplbmFibGUgPSBNVEtfRU5BQkxFOw0KKwl9
IGVsc2UNCisJCWVyciA9IC1FSU5WQUw7DQorDQorb3V0Og0KKwlyZXR1cm4gZXJyOw0KK30NCisN
CitzdGF0aWMgaW50IG10a19waW5jb25mX2JpYXNfZ2V0X3B1bGxzZWxfcHVsbGVuKHN0cnVjdCBt
dGtfcGluY3RybCAqaHcsDQorCQkJCWNvbnN0IHN0cnVjdCBtdGtfcGluX2Rlc2MgKmRlc2MsDQor
CQkJCXUzMiAqcHVsbHVwLCB1MzIgKmVuYWJsZSkNCit7DQorCWludCBlcnI7DQorDQorCWVyciA9
IG10a19od19nZXRfdmFsdWUoaHcsIGRlc2MsIFBJTkNUUkxfUElOX1JFR19QVUxMU0VMLCBwdWxs
dXApOw0KKwlpZiAoZXJyKQ0KKwkJZ290byBvdXQ7DQorDQorCWVyciA9IG10a19od19nZXRfdmFs
dWUoaHcsIGRlc2MsIFBJTkNUUkxfUElOX1JFR19QVUxMRU4sIGVuYWJsZSk7DQorDQorb3V0Og0K
KwlyZXR1cm4gZXJyOw0KK30NCisNCitzdGF0aWMgaW50IG10a19waW5jb25mX2JpYXNfZ2V0X3B1
cGRfcjFfcjAoc3RydWN0IG10a19waW5jdHJsICpodywNCisJCQkJY29uc3Qgc3RydWN0IG10a19w
aW5fZGVzYyAqZGVzYywNCisJCQkJdTMyICpwdWxsdXAsIHUzMiAqZW5hYmxlKQ0KK3sNCisJaW50
IGVyciwgcjAsIHIxOw0KKw0KKwllcnIgPSBtdGtfaHdfZ2V0X3ZhbHVlKGh3LCBkZXNjLCBQSU5D
VFJMX1BJTl9SRUdfUFVQRCwgcHVsbHVwKTsNCisJaWYgKGVycikNCisJCWdvdG8gb3V0Ow0KKwkv
KiBNVEsgSFcgUFVQRCBiaXQ6IDEgZm9yIHB1bGwtZG93biwgMCBmb3IgcHVsbC11cCAqLw0KKwkq
cHVsbHVwID0gISgqcHVsbHVwKTsNCisNCisJZXJyID0gbXRrX2h3X2dldF92YWx1ZShodywgZGVz
YywgUElOQ1RSTF9QSU5fUkVHX1IwLCAmcjApOw0KKwlpZiAoZXJyKQ0KKwkJZ290byBvdXQ7DQor
DQorCWVyciA9IG10a19od19nZXRfdmFsdWUoaHcsIGRlc2MsIFBJTkNUUkxfUElOX1JFR19SMSwg
JnIxKTsNCisJaWYgKGVycikNCisJCWdvdG8gb3V0Ow0KKw0KKwlpZiAoKHIxID09IDApICYmIChy
MCA9PSAwKSkNCisJCSplbmFibGUgPSBNVEtfUFVQRF9TRVRfUjFSMF8wMDsNCisJZWxzZSBpZiAo
KHIxID09IDApICYmIChyMCA9PSAxKSkNCisJCSplbmFibGUgPSBNVEtfUFVQRF9TRVRfUjFSMF8w
MTsNCisJZWxzZSBpZiAoKHIxID09IDEpICYmIChyMCA9PSAwKSkNCisJCSplbmFibGUgPSBNVEtf
UFVQRF9TRVRfUjFSMF8xMDsNCisJZWxzZSBpZiAoKHIxID09IDEpICYmIChyMCA9PSAxKSkNCisJ
CSplbmFibGUgPSBNVEtfUFVQRF9TRVRfUjFSMF8xMTsNCisJZWxzZQ0KKwkJZXJyID0gLUVJTlZB
TDsNCisNCitvdXQ6DQorCXJldHVybiBlcnI7DQorfQ0KKw0KK2ludCBtdGtfcGluY29uZl9iaWFz
X3NldF9jb21ibyhzdHJ1Y3QgbXRrX3BpbmN0cmwgKmh3LA0KKwkJCQljb25zdCBzdHJ1Y3QgbXRr
X3Bpbl9kZXNjICpkZXNjLA0KKwkJCQl1MzIgcHVsbHVwLCB1MzIgYXJnKQ0KK3sNCisJaW50IGVy
cjsNCisNCisJZXJyID0gbXRrX3BpbmNvbmZfYmlhc19zZXRfcHVfcGQoaHcsIGRlc2MsIHB1bGx1
cCwgYXJnKTsNCisJaWYgKCFlcnIpDQorCQlnb3RvIG91dDsNCisNCisJZXJyID0gbXRrX3BpbmNv
bmZfYmlhc19zZXRfcHVsbHNlbF9wdWxsZW4oaHcsIGRlc2MsIHB1bGx1cCwgYXJnKTsNCisJaWYg
KCFlcnIpDQorCQlnb3RvIG91dDsNCisNCisJZXJyID0gbXRrX3BpbmNvbmZfYmlhc19zZXRfcHVw
ZF9yMV9yMChodywgZGVzYywgcHVsbHVwLCBhcmcpOw0KKw0KK291dDoNCisJcmV0dXJuIGVycjsN
Cit9DQorDQoraW50IG10a19waW5jb25mX2JpYXNfZ2V0X2NvbWJvKHN0cnVjdCBtdGtfcGluY3Ry
bCAqaHcsDQorCQkJICAgICAgY29uc3Qgc3RydWN0IG10a19waW5fZGVzYyAqZGVzYywNCisJCQkg
ICAgICB1MzIgKnB1bGx1cCwgdTMyICplbmFibGUpDQorew0KKwlpbnQgZXJyOw0KKw0KKwllcnIg
PSBtdGtfcGluY29uZl9iaWFzX2dldF9wdV9wZChodywgZGVzYywgcHVsbHVwLCBlbmFibGUpOw0K
KwlpZiAoIWVycikNCisJCWdvdG8gb3V0Ow0KKw0KKwllcnIgPSBtdGtfcGluY29uZl9iaWFzX2dl
dF9wdWxsc2VsX3B1bGxlbihodywgZGVzYywgcHVsbHVwLCBlbmFibGUpOw0KKwlpZiAoIWVycikN
CisJCWdvdG8gb3V0Ow0KKw0KKwllcnIgPSBtdGtfcGluY29uZl9iaWFzX2dldF9wdXBkX3IxX3Iw
KGh3LCBkZXNjLCBwdWxsdXAsIGVuYWJsZSk7DQorDQorb3V0Og0KKwlyZXR1cm4gZXJyOw0KK30N
CisNCiAvKiBSZXZpc2lvbiAwICovDQogaW50IG10a19waW5jb25mX2RyaXZlX3NldChzdHJ1Y3Qg
bXRrX3BpbmN0cmwgKmh3LA0KIAkJCSAgY29uc3Qgc3RydWN0IG10a19waW5fZGVzYyAqZGVzYywg
dTMyIGFyZykNCmRpZmYgLS1naXQgYS9kcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1t
dGstY29tbW9uLXYyLmggYi9kcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1tdGstY29t
bW9uLXYyLmgNCmluZGV4IDc1ZDBlMDcuLjI3ZGYwODcgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL3Bp
bmN0cmwvbWVkaWF0ZWsvcGluY3RybC1tdGstY29tbW9uLXYyLmgNCisrKyBiL2RyaXZlcnMvcGlu
Y3RybC9tZWRpYXRlay9waW5jdHJsLW10ay1jb21tb24tdjIuaA0KQEAgLTIxNiw2ICsyMTYsMTEg
QEAgc3RydWN0IG10a19waW5fc29jIHsNCiAJaW50ICgqYmlhc19nZXQpKHN0cnVjdCBtdGtfcGlu
Y3RybCAqaHcsDQogCQkJY29uc3Qgc3RydWN0IG10a19waW5fZGVzYyAqZGVzYywgYm9vbCBwdWxs
dXAsIGludCAqcmVzKTsNCiANCisJaW50ICgqYmlhc19zZXRfY29tYm8pKHN0cnVjdCBtdGtfcGlu
Y3RybCAqaHcsDQorCQkJY29uc3Qgc3RydWN0IG10a19waW5fZGVzYyAqZGVzYywgdTMyIHB1bGx1
cCwgdTMyIGFyZyk7DQorCWludCAoKmJpYXNfZ2V0X2NvbWJvKShzdHJ1Y3QgbXRrX3BpbmN0cmwg
Kmh3LA0KKwkJCWNvbnN0IHN0cnVjdCBtdGtfcGluX2Rlc2MgKmRlc2MsIHUzMiAqcHVsbHVwLCB1
MzIgKmFyZyk7DQorDQogCWludCAoKmRyaXZlX3NldCkoc3RydWN0IG10a19waW5jdHJsICpodywN
CiAJCQkgY29uc3Qgc3RydWN0IG10a19waW5fZGVzYyAqZGVzYywgdTMyIGFyZyk7DQogCWludCAo
KmRyaXZlX2dldCkoc3RydWN0IG10a19waW5jdHJsICpodywNCkBAIC0yNzcsNiArMjgyLDEyIEBA
IGludCBtdGtfcGluY29uZl9iaWFzX3NldF9yZXYxKHN0cnVjdCBtdGtfcGluY3RybCAqaHcsDQog
aW50IG10a19waW5jb25mX2JpYXNfZ2V0X3JldjEoc3RydWN0IG10a19waW5jdHJsICpodywNCiAJ
CQkgICAgICBjb25zdCBzdHJ1Y3QgbXRrX3Bpbl9kZXNjICpkZXNjLCBib29sIHB1bGx1cCwNCiAJ
CQkgICAgICBpbnQgKnJlcyk7DQoraW50IG10a19waW5jb25mX2JpYXNfc2V0X2NvbWJvKHN0cnVj
dCBtdGtfcGluY3RybCAqaHcsDQorCQkJCWNvbnN0IHN0cnVjdCBtdGtfcGluX2Rlc2MgKmRlc2Ms
DQorCQkJCXUzMiBwdWxsdXAsIHUzMiBlbmFibGUpOw0KK2ludCBtdGtfcGluY29uZl9iaWFzX2dl
dF9jb21ibyhzdHJ1Y3QgbXRrX3BpbmN0cmwgKmh3LA0KKwkJCSAgICAgIGNvbnN0IHN0cnVjdCBt
dGtfcGluX2Rlc2MgKmRlc2MsDQorCQkJICAgICAgdTMyICpwdWxsdXAsIHUzMiAqZW5hYmxlKTsN
CiANCiBpbnQgbXRrX3BpbmNvbmZfZHJpdmVfc2V0KHN0cnVjdCBtdGtfcGluY3RybCAqaHcsDQog
CQkJICBjb25zdCBzdHJ1Y3QgbXRrX3Bpbl9kZXNjICpkZXNjLCB1MzIgYXJnKTsNCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1wYXJpcy5jIGIvZHJpdmVycy9w
aW5jdHJsL21lZGlhdGVrL3BpbmN0cmwtcGFyaXMuYw0KaW5kZXggZDA5YTcyNi4uMTE1ZWJjMSAx
MDA2NDQNCi0tLSBhL2RyaXZlcnMvcGluY3RybC9tZWRpYXRlay9waW5jdHJsLXBhcmlzLmMNCisr
KyBiL2RyaXZlcnMvcGluY3RybC9tZWRpYXRlay9waW5jdHJsLXBhcmlzLmMNCkBAIC03OCw3ICs3
OCw3IEBAIHN0YXRpYyBpbnQgbXRrX3BpbmNvbmZfZ2V0KHN0cnVjdCBwaW5jdHJsX2RldiAqcGN0
bGRldiwNCiB7DQogCXN0cnVjdCBtdGtfcGluY3RybCAqaHcgPSBwaW5jdHJsX2Rldl9nZXRfZHJ2
ZGF0YShwY3RsZGV2KTsNCiAJdTMyIHBhcmFtID0gcGluY29uZl90b19jb25maWdfcGFyYW0oKmNv
bmZpZyk7DQotCWludCBlcnIsIHJlZywgcmV0ID0gMTsNCisJaW50IHB1bGx1cCwgZXJyLCByZWcs
IHJldCA9IDE7DQogCWNvbnN0IHN0cnVjdCBtdGtfcGluX2Rlc2MgKmRlc2M7DQogDQogCWlmIChw
aW4gPj0gaHctPnNvYy0+bnBpbnMpIHsNCkBAIC04OSwyMiArODksMzEgQEAgc3RhdGljIGludCBt
dGtfcGluY29uZl9nZXQoc3RydWN0IHBpbmN0cmxfZGV2ICpwY3RsZGV2LA0KIA0KIAlzd2l0Y2gg
KHBhcmFtKSB7DQogCWNhc2UgUElOX0NPTkZJR19CSUFTX0RJU0FCTEU6DQotCQlpZiAoaHctPnNv
Yy0+Ymlhc19kaXNhYmxlX2dldCkNCi0JCQllcnIgPSBody0+c29jLT5iaWFzX2Rpc2FibGVfZ2V0
KGh3LCBkZXNjLCAmcmV0KTsNCi0JCWVsc2UNCi0JCQllcnIgPSAtRU5PVFNVUFA7DQotCQlicmVh
azsNCiAJY2FzZSBQSU5fQ09ORklHX0JJQVNfUFVMTF9VUDoNCi0JCWlmIChody0+c29jLT5iaWFz
X2dldCkNCi0JCQllcnIgPSBody0+c29jLT5iaWFzX2dldChodywgZGVzYywgMSwgJnJldCk7DQot
CQllbHNlDQotCQkJZXJyID0gLUVOT1RTVVBQOw0KLQkJYnJlYWs7DQogCWNhc2UgUElOX0NPTkZJ
R19CSUFTX1BVTExfRE9XTjoNCi0JCWlmIChody0+c29jLT5iaWFzX2dldCkNCi0JCQllcnIgPSBo
dy0+c29jLT5iaWFzX2dldChodywgZGVzYywgMCwgJnJldCk7DQotCQllbHNlDQorCQlpZiAoaHct
PnNvYy0+Ymlhc19nZXRfY29tYm8pIHsNCisJCQllcnIgPSBody0+c29jLT5iaWFzX2dldF9jb21i
byhodywgZGVzYywgJnB1bGx1cCwgJnJldCk7DQorCQkJaWYgKGVycikNCisJCQkJZ290byBvdXQ7
DQorCQkJaWYgKHBhcmFtID09IFBJTl9DT05GSUdfQklBU19ESVNBQkxFKSB7DQorCQkJCWlmIChy
ZXQgPT0gTVRLX1BVUERfU0VUX1IxUjBfMDApDQorCQkJCQlyZXQgPSBNVEtfRElTQUJMRTsNCisJ
CQl9IGVsc2UgaWYgKHBhcmFtID09IFBJTl9DT05GSUdfQklBU19QVUxMX1VQKSB7DQorCQkJCS8q
IFdoZW4gZGVzaXJlIHRvIGdldCBwdWxsLXVwIHZhbHVlLCByZXR1cm4NCisJCQkJICogIGVycm9y
IGlmIGN1cnJlbnQgc2V0dGluZyBpcyBwdWxsLWRvd24NCisJCQkJICovDQorCQkJCWlmICghcHVs
bHVwKQ0KKwkJCQkJZXJyID0gLUVJTlZBTDsNCisJCQl9IGVsc2UgaWYgKHBhcmFtID09IFBJTl9D
T05GSUdfQklBU19QVUxMX0RPV04pIHsNCisJCQkJLyogV2hlbiBkZXNpcmUgdG8gZ2V0IHB1bGwt
ZG93biB2YWx1ZSwgcmV0dXJuDQorCQkJCSAqICBlcnJvciBpZiBjdXJyZW50IHNldHRpbmcgaXMg
cHVsbC11cA0KKwkJCQkgKi8NCisJCQkJaWYgKHB1bGx1cCkNCisJCQkJCWVyciA9IC1FSU5WQUw7
DQorCQkJfQ0KKwkJfSBlbHNlIHsNCiAJCQllcnIgPSAtRU5PVFNVUFA7DQorCQl9DQogCQlicmVh
azsNCiAJY2FzZSBQSU5fQ09ORklHX1NMRVdfUkFURToNCiAJCWVyciA9IG10a19od19nZXRfdmFs
dWUoaHcsIGRlc2MsIFBJTkNUUkxfUElOX1JFR19TUiwgJnJldCk7DQpAQCAtMTk2LDIwICsyMDUs
MjAgQEAgc3RhdGljIGludCBtdGtfcGluY29uZl9zZXQoc3RydWN0IHBpbmN0cmxfZGV2ICpwY3Rs
ZGV2LCB1bnNpZ25lZCBpbnQgcGluLA0KIA0KIAlzd2l0Y2ggKCh1MzIpcGFyYW0pIHsNCiAJY2Fz
ZSBQSU5fQ09ORklHX0JJQVNfRElTQUJMRToNCi0JCWlmIChody0+c29jLT5iaWFzX2Rpc2FibGVf
c2V0KQ0KLQkJCWVyciA9IGh3LT5zb2MtPmJpYXNfZGlzYWJsZV9zZXQoaHcsIGRlc2MpOw0KKwkJ
aWYgKGh3LT5zb2MtPmJpYXNfc2V0X2NvbWJvKQ0KKwkJCWVyciA9IGh3LT5zb2MtPmJpYXNfc2V0
X2NvbWJvKGh3LCBkZXNjLCAwLCBNVEtfRElTQUJMRSk7DQogCQllbHNlDQogCQkJZXJyID0gLUVO
T1RTVVBQOw0KIAkJYnJlYWs7DQogCWNhc2UgUElOX0NPTkZJR19CSUFTX1BVTExfVVA6DQotCQlp
ZiAoaHctPnNvYy0+Ymlhc19zZXQpDQotCQkJZXJyID0gaHctPnNvYy0+Ymlhc19zZXQoaHcsIGRl
c2MsIDEpOw0KKwkJaWYgKGh3LT5zb2MtPmJpYXNfc2V0X2NvbWJvKQ0KKwkJCWVyciA9IGh3LT5z
b2MtPmJpYXNfc2V0X2NvbWJvKGh3LCBkZXNjLCAxLCBhcmcpOw0KIAkJZWxzZQ0KIAkJCWVyciA9
IC1FTk9UU1VQUDsNCiAJCWJyZWFrOw0KIAljYXNlIFBJTl9DT05GSUdfQklBU19QVUxMX0RPV046
DQotCQlpZiAoaHctPnNvYy0+Ymlhc19zZXQpDQotCQkJZXJyID0gaHctPnNvYy0+Ymlhc19zZXQo
aHcsIGRlc2MsIDApOw0KKwkJaWYgKGh3LT5zb2MtPmJpYXNfc2V0X2NvbWJvKQ0KKwkJCWVyciA9
IGh3LT5zb2MtPmJpYXNfc2V0X2NvbWJvKGh3LCBkZXNjLCAwLCBhcmcpOw0KIAkJZWxzZQ0KIAkJ
CWVyciA9IC1FTk9UU1VQUDsNCiAJCWJyZWFrOw0KLS0gDQoxLjguMS4xLmRpcnR5DQo=

