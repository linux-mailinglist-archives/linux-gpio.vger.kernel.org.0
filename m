Return-Path: <linux-gpio-owner@vger.kernel.org>
X-Original-To: lists+linux-gpio@lfdr.de
Delivered-To: lists+linux-gpio@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id CF1AF144C07
	for <lists+linux-gpio@lfdr.de>; Wed, 22 Jan 2020 07:53:59 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726103AbgAVGxY (ORCPT <rfc822;lists+linux-gpio@lfdr.de>);
        Wed, 22 Jan 2020 01:53:24 -0500
Received: from mailgw02.mediatek.com ([210.61.82.184]:7754 "EHLO
        mailgw02.mediatek.com" rhost-flags-OK-FAIL-OK-FAIL) by vger.kernel.org
        with ESMTP id S1725884AbgAVGxY (ORCPT
        <rfc822;linux-gpio@vger.kernel.org>); Wed, 22 Jan 2020 01:53:24 -0500
X-UUID: 7ea6983bb9d9486785d06bcd5b84f0db-20200122
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=mediatek.com; s=dk;
        h=Content-Transfer-Encoding:Content-Type:MIME-Version:Message-ID:Date:Subject:CC:To:From; bh=Bkkv2SlP/58V7+P3Bi8i3ZC64d86zcDO203xGyHiNBg=;
        b=lFTMEXVlMJsyXXM9Pka6P0VqG6juX++DUWU+D3/25oO25OqA2jQgoRA+zsaekCDW/etkHGAkwXvqTqnyCg1tgKwH0tfoYzfryc1kGrCPeycSRSlDOs9Cqkworb8FtYi4HKwkSwM1Oofb2O6QyFkkEQBZvNRcG46Co+iCorZKc/o=;
X-UUID: 7ea6983bb9d9486785d06bcd5b84f0db-20200122
Received: from mtkexhb02.mediatek.inc [(172.21.101.103)] by mailgw02.mediatek.com
        (envelope-from <light.hsieh@mediatek.com>)
        (Cellopoint E-mail Firewall v4.1.10 Build 0809 with TLS)
        with ESMTP id 2060551540; Wed, 22 Jan 2020 14:53:17 +0800
Received: from mtkcas07.mediatek.inc (172.21.101.84) by
 mtkmbs02n2.mediatek.inc (172.21.101.101) with Microsoft SMTP Server (TLS) id
 15.0.1395.4; Wed, 22 Jan 2020 14:52:13 +0800
Received: from mtkswgap22.mediatek.inc (172.21.77.33) by mtkcas07.mediatek.inc
 (172.21.101.73) with Microsoft SMTP Server id 15.0.1395.4 via Frontend
 Transport; Wed, 22 Jan 2020 14:51:57 +0800
From:   <light.hsieh@mediatek.com>
To:     <linus.walleij@linaro.org>
CC:     <linux-mediatek@lists.infradead.org>, <linux-gpio@vger.kernel.org>,
        <linux-kernel@vger.kernel.org>, <sean.wang@kernel.org>,
        <kuohong.wang@mediatek.com>, Light Hsieh <light.hsieh@mediatek.com>
Subject: [PATCH v8 1/6] pinctrl: mediatek: Check gpio pin number and use binary search in mtk_hw_pin_field_lookup()
Date:   Wed, 22 Jan 2020 14:53:09 +0800
Message-ID: <1579675994-7001-1-git-send-email-light.hsieh@mediatek.com>
X-Mailer: git-send-email 1.8.1.1.dirty
MIME-Version: 1.0
Content-Type: text/plain
X-TM-SNTS-SMTP: 660429F95FABC97ED3652C11CAB95C6BF2D0D521B77C9A655959A16674A913DA2000:8
X-MTK:  N
Content-Transfer-Encoding: base64
Sender: linux-gpio-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-gpio.vger.kernel.org>
X-Mailing-List: linux-gpio@vger.kernel.org

RnJvbTogTGlnaHQgSHNpZWggPGxpZ2h0LmhzaWVoQG1lZGlhdGVrLmNvbT4NCg0KMS4gQ2hlY2sg
aWYgZ3BpbyBwaW4gbnVtYmVyIGlzIGluIHZhbGlkIHJhbmdlIHRvIHByZXZlbnQgZnJvbSBnZXQg
aW52YWxpZA0KICAgcG9pbnRlciAnZGVzYycgaW4gdGhlIGZvbGxvd2luZyBjb2RlOg0KCWRlc2Mg
PSAoY29uc3Qgc3RydWN0IG10a19waW5fZGVzYyAqKSZody0+c29jLT5waW5zW2dwaW9dOw0KDQoy
LiBJbXByb3ZlICBtdGtfaHdfcGluX2ZpZWxkX2xvb2t1cCgpDQoyLjEgTW9kaWZ5IG10a19od19w
aW5fZmllbGRfbG9va3VwKCkgdG8gdXNlIGJpbmFyeSBzZWFyY2ggZm9yIGFjY2VsZXJhdGluZw0K
ICAgICBzZWFyY2guDQoyLjIgQ29ycmVjdCBtZXNzYWdlIGFmdGVyIHRoZSBmb2xsb3dpbmcgY2hl
Y2sgZmFpbDoNCiAgICBpZiAoaHctPnNvYy0+cmVnX2NhbCAmJiBody0+c29jLT5yZWdfY2FsW2Zp
ZWxkXS5yYW5nZSkgew0KCQlyYyA9ICZody0+c29jLT5yZWdfY2FsW2ZpZWxkXTsNCiAgICBUaGUg
b3JpZ2luYWwgbWVzc2FnZSBpczoNCiAgICAJIk5vdCBzdXBwb3J0IGZpZWxkICVkIGZvciBwaW4g
JWQgKCVzKVxuIg0KICAgIEhvd2V2ZXIsIHRoZSBjaGVjayBpcyBvbiBzb2MgY2hpcCBsZXZlbCwg
bm90IG9uIHBpbiBsZXZlbCB5ZXQuDQogICAgU28gdGhlIG1lc3NhZ2UgaXMgY29ycmVjdGVkIGFz
Og0KICAgIAkiTm90IHN1cHBvcnQgZmllbGQgJWQgZm9yIHRoaXMgc29jXG4iDQoNClNpZ25lZC1v
ZmYtYnk6IExpZ2h0IEhzaWVoIDxsaWdodC5oc2llaEBtZWRpYXRlay5jb20+DQotLS0NCiBkcml2
ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1tdGstY29tbW9uLXYyLmMgfCAyNyArKysrKysr
KysrKysrKysrKystLS0tLS0NCiBkcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1wYXJp
cy5jICAgICAgICAgfCAyNSArKysrKysrKysrKysrKysrKysrKysrDQogMiBmaWxlcyBjaGFuZ2Vk
LCA0NiBpbnNlcnRpb25zKCspLCA2IGRlbGV0aW9ucygtKQ0KDQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9waW5jdHJsL21lZGlhdGVrL3BpbmN0cmwtbXRrLWNvbW1vbi12Mi5jIGIvZHJpdmVycy9waW5j
dHJsL21lZGlhdGVrL3BpbmN0cmwtbXRrLWNvbW1vbi12Mi5jDQppbmRleCAyMGUxYzg5Li5kNjNl
MDVlIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9waW5jdHJsL21lZGlhdGVrL3BpbmN0cmwtbXRrLWNv
bW1vbi12Mi5jDQorKysgYi9kcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1tdGstY29t
bW9uLXYyLmMNCkBAIC02OCwzMiArNjgsNDQgQEAgc3RhdGljIGludCBtdGtfaHdfcGluX2ZpZWxk
X2xvb2t1cChzdHJ1Y3QgbXRrX3BpbmN0cmwgKmh3LA0KIHsNCiAJY29uc3Qgc3RydWN0IG10a19w
aW5fZmllbGRfY2FsYyAqYywgKmU7DQogCWNvbnN0IHN0cnVjdCBtdGtfcGluX3JlZ19jYWxjICpy
YzsNCisJaW50IHN0YXJ0ID0gMCwgZW5kLCBjaGVjazsNCisJYm9vbCBmb3VuZCA9IGZhbHNlOw0K
IAl1MzIgYml0czsNCiANCiAJaWYgKGh3LT5zb2MtPnJlZ19jYWwgJiYgaHctPnNvYy0+cmVnX2Nh
bFtmaWVsZF0ucmFuZ2UpIHsNCiAJCXJjID0gJmh3LT5zb2MtPnJlZ19jYWxbZmllbGRdOw0KIAl9
IGVsc2Ugew0KIAkJZGV2X2RiZyhody0+ZGV2LA0KLQkJCSJOb3Qgc3VwcG9ydCBmaWVsZCAlZCBm
b3IgcGluICVkICglcylcbiIsDQotCQkJZmllbGQsIGRlc2MtPm51bWJlciwgZGVzYy0+bmFtZSk7
DQorCQkJIk5vdCBzdXBwb3J0IGZpZWxkICVkIGZvciB0aGlzIHNvY1xuIiwgZmllbGQpOw0KIAkJ
cmV0dXJuIC1FTk9UU1VQUDsNCiAJfQ0KIA0KKwllbmQgPSByYy0+bnJhbmdlcyAtIDE7DQogCWMg
PSByYy0+cmFuZ2U7DQogCWUgPSBjICsgcmMtPm5yYW5nZXM7DQogDQotCXdoaWxlIChjIDwgZSkg
ew0KLQkJaWYgKGRlc2MtPm51bWJlciA+PSBjLT5zX3BpbiAmJiBkZXNjLT5udW1iZXIgPD0gYy0+
ZV9waW4pDQorCXdoaWxlIChzdGFydCA8PSBlbmQpIHsNCisJCWNoZWNrID0gKHN0YXJ0ICsgZW5k
KSA+PiAxOw0KKwkJaWYgKGRlc2MtPm51bWJlciA+PSByYy0+cmFuZ2VbY2hlY2tdLnNfcGluDQor
CQkgJiYgZGVzYy0+bnVtYmVyIDw9IHJjLT5yYW5nZVtjaGVja10uZV9waW4pIHsNCisJCQlmb3Vu
ZCA9IHRydWU7DQorCQkJYnJlYWs7DQorCQl9IGVsc2UgaWYgKHN0YXJ0ID09IGVuZCkNCiAJCQli
cmVhazsNCi0JCWMrKzsNCisJCWVsc2UgaWYgKGRlc2MtPm51bWJlciA8IHJjLT5yYW5nZVtjaGVj
a10uc19waW4pDQorCQkJZW5kID0gY2hlY2sgLSAxOw0KKwkJZWxzZQ0KKwkJCXN0YXJ0ID0gY2hl
Y2sgKyAxOw0KIAl9DQogDQotCWlmIChjID49IGUpIHsNCisJaWYgKCFmb3VuZCkgew0KIAkJZGV2
X2RiZyhody0+ZGV2LCAiTm90IHN1cHBvcnQgZmllbGQgJWQgZm9yIHBpbiA9ICVkICglcylcbiIs
DQogCQkJZmllbGQsIGRlc2MtPm51bWJlciwgZGVzYy0+bmFtZSk7DQogCQlyZXR1cm4gLUVOT1RT
VVBQOw0KIAl9DQogDQorCWMgPSByYy0+cmFuZ2UgKyBjaGVjazsNCisNCiAJaWYgKGMtPmlfYmFz
ZSA+IGh3LT5uYmFzZSAtIDEpIHsNCiAJCWRldl9lcnIoaHctPmRldiwNCiAJCQkiSW52YWxpZCBi
YXNlIGZvciBmaWVsZCAlZCBmb3IgcGluID0gJWQgKCVzKVxuIiwNCkBAIC0xODIsNiArMTk0LDkg
QEAgaW50IG10a19od19zZXRfdmFsdWUoc3RydWN0IG10a19waW5jdHJsICpodywgY29uc3Qgc3Ry
dWN0IG10a19waW5fZGVzYyAqZGVzYywNCiAJaWYgKGVycikNCiAJCXJldHVybiBlcnI7DQogDQor
CWlmICh2YWx1ZSA8IDAgfHwgdmFsdWUgPiBwZi5tYXNrKQ0KKwkJcmV0dXJuIC1FSU5WQUw7DQor
DQogCWlmICghcGYubmV4dCkNCiAJCW10a19ybXcoaHcsIHBmLmluZGV4LCBwZi5vZmZzZXQsIHBm
Lm1hc2sgPDwgcGYuYml0cG9zLA0KIAkJCSh2YWx1ZSAmIHBmLm1hc2spIDw8IHBmLmJpdHBvcyk7
DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9waW5jdHJsL21lZGlhdGVrL3BpbmN0cmwtcGFyaXMuYyBi
L2RyaXZlcnMvcGluY3RybC9tZWRpYXRlay9waW5jdHJsLXBhcmlzLmMNCmluZGV4IDkyMzI2NGQu
LjNlMTNhZTcgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1w
YXJpcy5jDQorKysgYi9kcml2ZXJzL3BpbmN0cmwvbWVkaWF0ZWsvcGluY3RybC1wYXJpcy5jDQpA
QCAtODEsNiArODEsOCBAQCBzdGF0aWMgaW50IG10a19waW5jb25mX2dldChzdHJ1Y3QgcGluY3Ry
bF9kZXYgKnBjdGxkZXYsDQogCWludCB2YWwsIHZhbDIsIGVyciwgcmVnLCByZXQgPSAxOw0KIAlj
b25zdCBzdHJ1Y3QgbXRrX3Bpbl9kZXNjICpkZXNjOw0KIA0KKwlpZiAocGluID49IGh3LT5zb2Mt
Pm5waW5zKQ0KKwkJcmV0dXJuIC1FSU5WQUw7DQogCWRlc2MgPSAoY29uc3Qgc3RydWN0IG10a19w
aW5fZGVzYyAqKSZody0+c29jLT5waW5zW3Bpbl07DQogDQogCXN3aXRjaCAocGFyYW0pIHsNCkBA
IC0yMDYsNiArMjA4LDEwIEBAIHN0YXRpYyBpbnQgbXRrX3BpbmNvbmZfc2V0KHN0cnVjdCBwaW5j
dHJsX2RldiAqcGN0bGRldiwgdW5zaWduZWQgaW50IHBpbiwNCiAJaW50IGVyciA9IDA7DQogCXUz
MiByZWc7DQogDQorCWlmIChwaW4gPj0gaHctPnNvYy0+bnBpbnMpIHsNCisJCWVyciA9IC1FSU5W
QUw7DQorCQlnb3RvIGVycjsNCisJfQ0KIAlkZXNjID0gKGNvbnN0IHN0cnVjdCBtdGtfcGluX2Rl
c2MgKikmaHctPnNvYy0+cGluc1twaW5dOw0KIA0KIAlzd2l0Y2ggKCh1MzIpcGFyYW0pIHsNCkBA
IC02OTMsNiArNjk5LDkgQEAgc3RhdGljIGludCBtdGtfZ3Bpb19nZXRfZGlyZWN0aW9uKHN0cnVj
dCBncGlvX2NoaXAgKmNoaXAsIHVuc2lnbmVkIGludCBncGlvKQ0KIAljb25zdCBzdHJ1Y3QgbXRr
X3Bpbl9kZXNjICpkZXNjOw0KIAlpbnQgdmFsdWUsIGVycjsNCiANCisJaWYgKGdwaW8gPiBody0+
c29jLT5ucGlucykNCisJCXJldHVybiAtRUlOVkFMOw0KKw0KIAlkZXNjID0gKGNvbnN0IHN0cnVj
dCBtdGtfcGluX2Rlc2MgKikmaHctPnNvYy0+cGluc1tncGlvXTsNCiANCiAJZXJyID0gbXRrX2h3
X2dldF92YWx1ZShodywgZGVzYywgUElOQ1RSTF9QSU5fUkVHX0RJUiwgJnZhbHVlKTsNCkBAIC03
MDgsNiArNzE3LDkgQEAgc3RhdGljIGludCBtdGtfZ3Bpb19nZXQoc3RydWN0IGdwaW9fY2hpcCAq
Y2hpcCwgdW5zaWduZWQgaW50IGdwaW8pDQogCWNvbnN0IHN0cnVjdCBtdGtfcGluX2Rlc2MgKmRl
c2M7DQogCWludCB2YWx1ZSwgZXJyOw0KIA0KKwlpZiAoZ3BpbyA+IGh3LT5zb2MtPm5waW5zKQ0K
KwkJcmV0dXJuIC1FSU5WQUw7DQorDQogCWRlc2MgPSAoY29uc3Qgc3RydWN0IG10a19waW5fZGVz
YyAqKSZody0+c29jLT5waW5zW2dwaW9dOw0KIA0KIAllcnIgPSBtdGtfaHdfZ2V0X3ZhbHVlKGh3
LCBkZXNjLCBQSU5DVFJMX1BJTl9SRUdfREksICZ2YWx1ZSk7DQpAQCAtNzIyLDYgKzczNCw5IEBA
IHN0YXRpYyB2b2lkIG10a19ncGlvX3NldChzdHJ1Y3QgZ3Bpb19jaGlwICpjaGlwLCB1bnNpZ25l
ZCBpbnQgZ3BpbywgaW50IHZhbHVlKQ0KIAlzdHJ1Y3QgbXRrX3BpbmN0cmwgKmh3ID0gZ3Bpb2No
aXBfZ2V0X2RhdGEoY2hpcCk7DQogCWNvbnN0IHN0cnVjdCBtdGtfcGluX2Rlc2MgKmRlc2M7DQog
DQorCWlmIChncGlvID4gaHctPnNvYy0+bnBpbnMpDQorCQlyZXR1cm47DQorDQogCWRlc2MgPSAo
Y29uc3Qgc3RydWN0IG10a19waW5fZGVzYyAqKSZody0+c29jLT5waW5zW2dwaW9dOw0KIA0KIAlt
dGtfaHdfc2V0X3ZhbHVlKGh3LCBkZXNjLCBQSU5DVFJMX1BJTl9SRUdfRE8sICEhdmFsdWUpOw0K
QEAgLTcyOSwxMiArNzQ0LDIyIEBAIHN0YXRpYyB2b2lkIG10a19ncGlvX3NldChzdHJ1Y3QgZ3Bp
b19jaGlwICpjaGlwLCB1bnNpZ25lZCBpbnQgZ3BpbywgaW50IHZhbHVlKQ0KIA0KIHN0YXRpYyBp
bnQgbXRrX2dwaW9fZGlyZWN0aW9uX2lucHV0KHN0cnVjdCBncGlvX2NoaXAgKmNoaXAsIHVuc2ln
bmVkIGludCBncGlvKQ0KIHsNCisJc3RydWN0IG10a19waW5jdHJsICpodyA9IGdwaW9jaGlwX2dl
dF9kYXRhKGNoaXApOw0KKw0KKwlpZiAoZ3BpbyA+IGh3LT5zb2MtPm5waW5zKQ0KKwkJcmV0dXJu
IC1FSU5WQUw7DQorDQogCXJldHVybiBwaW5jdHJsX2dwaW9fZGlyZWN0aW9uX2lucHV0KGNoaXAt
PmJhc2UgKyBncGlvKTsNCiB9DQogDQogc3RhdGljIGludCBtdGtfZ3Bpb19kaXJlY3Rpb25fb3V0
cHV0KHN0cnVjdCBncGlvX2NoaXAgKmNoaXAsIHVuc2lnbmVkIGludCBncGlvLA0KIAkJCQkgICAg
IGludCB2YWx1ZSkNCiB7DQorCXN0cnVjdCBtdGtfcGluY3RybCAqaHcgPSBncGlvY2hpcF9nZXRf
ZGF0YShjaGlwKTsNCisNCisJaWYgKGdwaW8gPiBody0+c29jLT5ucGlucykNCisJCXJldHVybiAt
RUlOVkFMOw0KKw0KIAltdGtfZ3Bpb19zZXQoY2hpcCwgZ3BpbywgdmFsdWUpOw0KIA0KIAlyZXR1
cm4gcGluY3RybF9ncGlvX2RpcmVjdGlvbl9vdXRwdXQoY2hpcC0+YmFzZSArIGdwaW8pOw0KLS0g
DQoxLjguMS4xLmRpcnR5DQo=

